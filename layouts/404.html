{{- define "main" -}}

{{ $css := resources.Get "css/404.css" | minify | fingerprint }}
<link rel="stylesheet" href="{{ $css.RelPermalink }}" integrity="{{ $css.Data.Integrity }}">

<script>
(function() {
  var path = window.location.pathname;

  // Special case: /glossary/vbeta/term â†’ try /glossary/english/term, fallback to /glossary/english/
  var vbetaMatch = path.match(/^\/glossary\/vbeta\/(.+)/);
  if (vbetaMatch) {
    var termPath = '/glossary/english/' + vbetaMatch[1];
    fetch(termPath, { method: 'HEAD' }).then(function(res) {
      window.location.replace(res.ok ? termPath : '/glossary/english/');
    }).catch(function() {
      window.location.replace('/glossary/english/');
    });
    return;
  }
  // /glossary/vbeta with no term
  if (/^\/glossary\/vbeta\/?$/.test(path)) {
    window.location.replace('/glossary/english/');
    return;
  }

  var redirects = [
    { pattern: /^\/curated_resources(\/|$)/, target: '/resources/' },
    { pattern: /^\/glossary\/([^/]+)\/.+/, target: '/glossary/$1/' },
    { pattern: /^\/author(\/|$)/, target: '/contributors/' },
    { pattern: /^\/summaries(\/|$)/, target: '/' },
    { pattern: /^\/reversals(\/|$)/, target: '/' }
  ];
  for (var i = 0; i < redirects.length; i++) {
    var match = path.match(redirects[i].pattern);
    if (match) {
      var target = redirects[i].target;
      for (var j = 1; j < match.length; j++) {
        target = target.replace('$' + j, match[j]);
      }
      window.location.replace(target);
      return;
    }
  }
})();
</script>

<div class="universal-wrapper pt-3">

  <h1>Whoops! Page not found</h1>

  {{/* Show search box if Academic's search engine is enabled. */}}
  {{ if eq site.Params.search.engine 1 }}
  <form class="d-flex align-items-center mb-3">
    <input name="q" type="search" class="form-control" placeholder="{{ i18n "search_placeholder" }}" autocomplete="off">
  </form>
  {{ end }}

  <div class="not-found-content">
    <p>That page can't be found. <strong>Please help us improve!</strong> If you reached this page through a broken link, let us know at <a href="mailto:info@forrt.org">info@forrt.org</a> or contact Lukas Wallrich on the <a href="https://forrt.slack.com/" target="_blank" rel="noopener">FORRT Slack</a>.</p>

    <div class="not-found-links">
      <h3>Here are some useful links:</h3>
      <ul>
        <li><a href="{{ .Site.BaseURL }}about/us">About FORRT</a></li>
        <li><a href="{{ .Site.BaseURL }}about/get-involved/">Get Involved</a></li>
        <li><a href="{{ .Site.BaseURL }}resources/">Curated Resources</a></li>
        <li><a href="{{ .Site.BaseURL }}glossary/">Glossary</a></li>
        <li><a href="{{ .Site.BaseURL }}replication-hub/">Replication Hub</a></li>
        <li><a href="{{ .Site.BaseURL }}lesson-plans/">Lesson Plans</a></li>
        <li><a href="{{ .Site.BaseURL }}publications/">Publications</a></li>
      </ul>
    </div>

    <p>Return <a href="{{ .Site.BaseURL }}">Home</a>.</p>
  </div>

</div>
{{- end -}}
