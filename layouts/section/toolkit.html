<div class="collapsible-table">
  <table>
    <thead>
      <tr>
        <th>Tool</th>
        <th>Description</th>
        <th class="source-header">Source</th>
      </tr>
    </thead>
    <tbody>
      {{ range $index, $tool := .Params.tools }}
      <tr class="collapsible-row">
        <td>
          <button class="toggle-button" aria-expanded="false" aria-controls="content-{{ $index }}">
            {{ $tool.name }}
            <span class="icon">+</span>
          </button>
        </td>
        <td>{{ $tool.description }}</td>
        <td class="source-cell">
          <a href="{{ $tool.url }}" target="_blank" rel="noopener">Source</a>
        </td>
      </tr>
      <tr class="content-row" id="content-{{ $index }}" hidden>
        <td colspan="3">
          <div class="content-wrapper">
            <div class="source-full">
              <a href="{{ $tool.url }}" target="_blank" rel="noopener">{{ $tool.source }}</a>
            </div>
            <p class="description-full">{{ $tool.description }}</p>
          </div>
        </td>
      </tr>
      {{ end }}
    </tbody>
  </table>
</div>

<style>
  .collapsible-table {
    margin: 2rem 0;
    overflow-x: auto;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
  }
  
  th, td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid #e2e8f0;
  }
  
  .toggle-button {
    background: none;
    border: none;
    padding: 0;
    font: inherit;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .icon {
    font-size: 1.25rem;
    transition: transform 0.3s;
  }
  
  [aria-expanded="true"] .icon {
    transform: rotate(45deg);
  }
  
  .source-header {
    display: none;
  }
  
  .source-cell {
    text-align: right;
  }
  
  .content-row td {
    padding: 0;
    border-bottom: 1px solid #cbd5e0;
  }
  
  .content-wrapper {
    padding: 1.5rem;
    background-color: #f7fafc;
  }
  
  .source-full {
    margin-bottom: 0.5rem;
    font-weight: 600;
  }
  
  .description-full {
    margin: 0;
    color: #4a5568;
  }
  
  @media (min-width: 768px) {
    .source-header {
      display: table-cell;
    }
    
    .source-cell {
      display: none;
    }
  }
</style>

<script>
  document.querySelectorAll('.toggle-button').forEach(button => {
    button.addEventListener('click', () => {
      const expanded = button.getAttribute('aria-expanded') === 'true';
      button.setAttribute('aria-expanded', !expanded);
      const content = document.getElementById(button.getAttribute('aria-controls'));
      content.hidden = expanded;
    });
  });
</script>
