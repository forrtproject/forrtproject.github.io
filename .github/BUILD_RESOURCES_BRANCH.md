# Build Resources Branch Documentation

## Overview

The `build-resources` branch is an automated branch that stores committed versions of generated markdown files. This allows reviewers to see the current state of generated content without needing to run data processing scripts locally.

## What Files Are Stored

The following generated files are automatically committed to the `build-resources` branch:

1. **Curated Resources** (`content/curated_resources/*.md`)
   - Individual resource markdown files generated from Google Sheets
   - Generated by: `content/resources/resource.py`
   - **Updated:** Daily (automatically)

2. **Tenzing Contributors** (`content/contributors/tenzing.md`)
   - Contributor list with roles and contributions
   - Generated by: `scripts/forrt_contribs/tenzing.py`
   - **Updated:** Daily (automatically)

3. **Glossary Files** (`content/glossary/*/`)
   - Glossary terms in multiple languages (English, German, Arabic, etc.)
   - Generated by: `content/glossary/_create_glossaries.py`
   - **Updated:** Only on manual trigger (see below)

## How It Works

### Automatic Updates

1. The `data-processing.yml` workflow runs daily at midnight (or manually)
2. **Daily runs** generate:
   - Curated resources
   - Tenzing contributors list
   - ⚠️ **Glossary files are NOT regenerated** (sources are less stable)
3. **Manual runs with glossary regeneration**:
   - Use workflow_dispatch with `regenerate_glossary: true` to update glossary
   - Only use this when glossary sources are confirmed stable
4. After generating files, the workflow:
   - Stores generated files temporarily
   - Switches to the `build-resources` branch
   - Copies the newly generated files
   - Commits and pushes changes if there are updates
   - Switches back to the original branch

5. The generated files are also uploaded as artifacts for the build process

### Dual Approach Benefits

This implementation uses a **dual approach**:

- **Artifacts** (primary): Fast, efficient for builds, automatically cleaned up
- **Branch** (secondary): Reviewable, trackable, provides version history

### Workflow Integration

```yaml
# In data-processing.yml (Daily)
- Generate files (tenzing, resources)
- Upload as artifacts (for builds)
- Commit to build-resources branch (for review)
- Trigger deployment

# Manual trigger with glossary regeneration
- workflow_dispatch with regenerate_glossary: true
- Generate files (tenzing, resources, glossary)
- Upload as artifacts (for builds)
- Commit to build-resources branch (for review)
- Trigger deployment
```

## Triggering Glossary Regeneration

Glossary files are **not** regenerated on daily runs because the sources are less stable. To regenerate glossary files:

1. Go to the Actions tab in GitHub
2. Select "Data Processing" workflow
3. Click "Run workflow"
4. Check the box for "Regenerate glossary files"
5. Click "Run workflow"

⚠️ **Important**: Only trigger glossary regeneration when the glossary sources (Google Docs) are confirmed stable and ready for update.

## Reviewing Generated Content

To review the latest generated content:

1. Go to the repository on GitHub
2. Switch to the `build-resources` branch
3. Navigate to:
   - `content/curated_resources/` for resources
   - `content/contributors/tenzing.md` for contributors
   - `content/glossary/english/` (or other languages) for glossary

## Build Process

The build process remains unchanged:

1. **Primary method**: Download from artifacts (fast)
2. **Fallback method**: Generate files if artifacts are unavailable

The `build-resources` branch does NOT impact the build process - it's purely for review purposes.

## Important Notes

- The `build-resources` branch is **automatically managed** - do not manually edit
- Files in this branch are **regenerated** from source data daily
- Any manual changes will be **overwritten** on the next data processing run
- To modify content, update the source data (Google Sheets) or generation scripts

## Version History

You can track changes to generated content by viewing the commit history of the `build-resources` branch:

```bash
git checkout build-resources
git log --oneline -- content/curated_resources/
git log --oneline -- content/contributors/tenzing.md
git log --oneline -- content/glossary/
```

## Troubleshooting

### Branch Not Found

If the `build-resources` branch doesn't exist yet, it will be automatically created on the next data processing run.

### Changes Not Appearing

If you don't see expected changes:

1. Check the latest data-processing workflow run
2. Verify the generation scripts ran successfully
3. Check if there were actual changes in the source data

### Merge Conflicts

This branch should never have merge conflicts since:
- It's not meant to be merged back to master
- All changes are automated
- Manual edits are discouraged

## Related Workflows

- `data-processing.yml`: Generates and commits files to this branch
- `deploy.yaml`: Uses artifacts (not this branch) for builds
- `staging-aggregate.yaml`: Uses artifacts (not this branch) for staging builds
